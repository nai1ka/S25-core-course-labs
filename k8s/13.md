


Before:


```bash
❱❱❱ kubectl get po
NAME                                              READY   STATUS    RESTARTS      AGE
python-app-python-time-service-744f8b746f-4szjb   1/1     Running   0             2m11s
vault-0                                           1/1     Running   1 (64m ago)   3d17h
vault-agent-injector-66f45b5fd5-dfmbp             1/1     Running   1 (64m ago)   3d17h
```

```bash
❱❱❱ argocd app get python-app
Name:               argocd/python-app
Project:            default
Server:             https://kubernetes.default.svc
Namespace:          default
URL:                https://argocd.example.com/applications/python-app
Source:
- Repo:             https://github.com/nai1ka/S25-core-course-labs.git
  Target:           lab13
  Path:             k8s/python-time-service
  Helm Values:      values.yaml
SyncWindow:         Sync Allowed
Sync Policy:        Automated
Sync Status:        Synced to lab13 (74d4114)
Health Status:      Healthy

GROUP  KIND            NAMESPACE  NAME                                   STATUS     HEALTH   HOOK      MESSAGE
       Pod             default    python-app-pre-install                 Succeeded           PreSync   pod/python-app-pre-install created
       ServiceAccount  default    python-app-python-time-service         Synced                        serviceaccount/python-app-python-time-service created
       ConfigMap       default    python-app-python-time-service-config  Synced                        configmap/python-app-python-time-service-config created
       Service         default    python-app-python-time-service         Synced     Healthy            service/python-app-python-time-service created
apps   Deployment      default    python-app-python-time-service         Synced     Healthy            deployment.apps/python-app-python-time-service created
       Pod             default    python-app-post-install                Succeeded           PostSync  pod/python-app-post-install created
```

I have changed `replicaCount` from 1 to 4
After

```bash
❱❱ kubectl get po
NAME                                              READY   STATUS    RESTARTS      AGE
python-app-python-time-service-744f8b746f-4szjb   1/1     Running   0             10m
python-app-python-time-service-744f8b746f-hfg47   1/1     Running   0             5m44s
python-app-python-time-service-744f8b746f-jcv75   1/1     Running   0             5m44s
python-app-python-time-service-744f8b746f-vfvcx   1/1     Running   0             5m44s
vault-0                                           1/1     Running   1 (72m ago)   3d17h
vault-agent-injector-66f45b5fd5-dfmbp             1/1     Running   1 (72m ago)   3d17h
```

```bash
❱❱❱ argocd app get python-app
Name:               argocd/python-app
Project:            default
Server:             https://kubernetes.default.svc
Namespace:          default
URL:                https://argocd.example.com/applications/python-app
Source:
- Repo:             https://github.com/nai1ka/S25-core-course-labs.git
  Target:           lab13
  Path:             k8s/python-time-service
  Helm Values:      values.yaml
SyncWindow:         Sync Allowed
Sync Policy:        Automated
Sync Status:        Synced to lab13 (a5429b5)
Health Status:      Healthy

GROUP  KIND            NAMESPACE  NAME                                   STATUS     HEALTH   HOOK      MESSAGE
       Pod             default    python-app-pre-install                 Succeeded           PreSync   pod/python-app-pre-install created
       ServiceAccount  default    python-app-python-time-service         Synced                        serviceaccount/python-app-python-time-service unchanged
       ConfigMap       default    python-app-python-time-service-config  Synced                        configmap/python-app-python-time-service-config unchanged
       Service         default    python-app-python-time-service         Synced     Healthy            service/python-app-python-time-service unchanged
apps   Deployment      default    python-app-python-time-service         Synced     Healthy            deployment.apps/python-app-python-time-service configured
       Pod             default    python-app-post-install                Succeeded           PostSync  pod/python-app-post-install created
```

As we can see, afther I pushed a commit (note that I am using commit --amend to maintain clean commit history, so there will be only one commit on GitHub) the number of replicatas became 4 and `Sync Status` changed to `Sync Status:        Synced to lab13 (a5429b5)` from Sync Status:        Synced to lab13 (74d4114). The hash of commit is different

## Task 2: Multi-Environment Deployment & Auto-Sync

I have added `argocd-python-dev.yaml` and `argocd-python-prod.yaml` to `ArgoCD` folder and `values-dev.yaml` with `values-prod.yaml` to th service folder.
For the development environment, I have set `replicaCount` to 2 and for the production environment, I have set `replicaCount` to 6.

```bash
❱❱❱ kubectl get pods -n prod
NAME                                                   READY   STATUS    RESTARTS      AGE
python-app-prod-python-time-service-574f976897-5hc2d   1/1     Running   2 (42m ago)   43m
python-app-prod-python-time-service-574f976897-5nw5m   1/1     Running   0             43m
python-app-prod-python-time-service-574f976897-llllq   1/1     Running   1 (42m ago)   43m
python-app-prod-python-time-service-574f976897-pvrf4   1/1     Running   0             43m
python-app-prod-python-time-service-574f976897-s5fht   1/1     Running   0             43m
python-app-prod-python-time-service-574f976897-sv7lq   1/1     Running   0             43m
```

```bash
kubectl patch deployment python-app-prod-python-time-service -n prod --patch '{"spec":{"replicas": 3}}'
deployment.apps/python-app-prod-python-time-service patched

❱❱❱ argocd app get python-app-prod
Name:               argocd/python-app-prod
Project:            default
Server:             https://kubernetes.default.svc
Namespace:          prod
URL:                https://argocd.example.com/applications/python-app-prod
Source:
- Repo:             https://github.com/nai1ka/S25-core-course-labs.git
  Target:           lab13
  Path:             k8s/python-time-service
  Helm Values:      values-prod.yaml
SyncWindow:         Sync Allowed
Sync Policy:        Automated
Sync Status:        Synced to lab13 (f01a676)
Health Status:      Progressing

GROUP  KIND            NAMESPACE  NAME                                        STATUS     HEALTH       HOOK     MESSAGE
       Pod             prod       python-app-prod-pre-install                 Succeeded               PreSync  pod/python-app-prod-pre-install created
       ServiceAccount  prod       python-app-prod-python-time-service         Synced                           serviceaccount/python-app-prod-python-time-service unchanged
       ConfigMap       prod       python-app-prod-python-time-service-config  Synced                           configmap/python-app-prod-python-time-service-config unchanged
       Service         prod       python-app-prod-python-time-service         Synced     Healthy               service/python-app-prod-python-time-service unchanged
apps   Deployment      prod       python-app-prod-python-time-service         Synced     Progressing           deployment.apps/python-app-prod-python-time-service configured

❱❱❱ kubectl get po -n prod
NAME                                                   READY   STATUS      RESTARTS         AGE
python-app-prod-post-install                           0/1     Completed   0                4d3h
python-app-prod-pre-install                            0/1     Completed   0                4d3h
python-app-prod-python-time-service-574f976897-2kz7g   1/1     Running     4 (3d3h ago)     4d3h
python-app-prod-python-time-service-574f976897-5nw5m   1/1     Running     2 (3d2h ago)     4d4h
python-app-prod-python-time-service-574f976897-m2dxx   1/1     Running     6 (2d1h ago)     4d3h
python-app-prod-python-time-service-574f976897-s5fht   1/1     Running     4                4d4h
python-app-prod-python-time-service-574f976897-sv7lq   1/1     Running     5 (2d4h ago)     4d4h
python-app-prod-python-time-service-574f976897-v5f7c   1/1     Running     13 (2d20h ago)   4d3h
```

## Test 2

```bash
kubectl delete pod -n prod python-app-prod-python-time-service-574f976897-v5f7c
pod "python-app-prod-python-time-service-574f976897-v5f7c" deleted


❱❱❱ kubectl get po -n prod
NAME                                                   READY   STATUS      RESTARTS       AGE
python-app-prod-post-install                           0/1     Completed   0              4d3h
python-app-prod-pre-install                            0/1     Completed   0              4d3h
python-app-prod-python-time-service-574f976897-2kz7g   1/1     Running     4 (3d3h ago)   4d3h
python-app-prod-python-time-service-574f976897-5nw5m   1/1     Running     2 (3d2h ago)   4d4h
python-app-prod-python-time-service-574f976897-lv927   1/1     Running     0              24s
python-app-prod-python-time-service-574f976897-m2dxx   1/1     Running     6 (2d1h ago)   4d3h
python-app-prod-python-time-service-574f976897-s5fht   1/1     Running     4              4d4h
python-app-prod-python-time-service-574f976897-sv7lq   1/1     Running     5 (2d4h ago)   4d4h

argocd app diff python-app-prod
[21:36:53] [~/Projects/S25-core-course-labs] ❱❱❱ 
```

The diff gived empty outout and exited with 0 code. It means that the state of the cluster is the same as the state of the git repository. The pod was recreated automatically